<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Create Post</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
<h1>Create a New Post</h1>
<div th:if="${successMessage}">
    <p th:text="${successMessage}"></p>
</div>

<form id="postForm" method="get">
    <div>
        <label for="title">Title:</label>
        <input type="text" id="title" name="title" />
    </div>
    <div>
        <label for="content">Content:</label><br>
        <textarea id="content" name="content" rows="4" cols="50"></textarea>
    </div>
</form>
<button id="sendPost" type="button">Post</button>
<script type="text/javascript" >
    $("#sendPost").on("click",function (e){
        console.log("hello");
        e.preventDefault();
        let idUser = localStorage.getItem('idUser');
        let title = $("#title").val();
        let content = $("#content").val();
        $.ajax({
            type:"POST",
            url:"/save",
            processData: false,
            data:JSON.stringify({
                idUser:idUser,
                title:title,
                content:content,
            }),
            contentType: "application/json",
            dataType: "json",
            success:function (data){
                if(data){
                    Swal.fire({
                        position: "top-end",
                        icon: "success",
                        title: "Thêm thành công",
                        showConfirmButton: false,
                        timer: 1500
                    });
                }else {
                    Swal.fire({
                        icon:"error",
                        title:"Error",
                    })
                }
            },
            error:function (e){
                console.log(e);
            }
        })
    })
</script>
</body>
</html>
